# sourcehut build
image: ubuntu/22.04
secrets:
  - 4fb99124-4e5f-4427-8796-3ccc0d953621
sources:
  - git@git.sr.ht:~ambrosebs/typedclojure
tasks:
  - install-clojure: |
      curl -L -O https://github.com/clojure/brew-install/releases/latest/download/linux-install.sh
      chmod +x linux-install.sh
      sudo ./linux-install.sh
  - deps:
      sudo apt-get install -y openjdk-17-jdk nodejs
  - test: |
      cd ../cljc.analyzer
      ./script/test
      cd ../cljs.analyzer
      ./script/test
      cd ../cljs.checker
      ./script/test
